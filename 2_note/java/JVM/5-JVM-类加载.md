# JVM

---

## 类加载

---

### 类加载

JVM 虚拟机执行 class 字节码的过程可以分为七个阶段：加载、验证、准备、解析、初始化、使用、卸载。

自定义加载器，必须继承 ClassLoader。

### 类的初始化步骤

如果这个类还没有被加载和链接，那先进行加载和链接；

假如这个类存在直接父类，并且这个类还没有被初始化 (注意：在一个类加载器中，类只能初始化一次)，那就初始化直接的父类 (不适用于接口)；

加入类中存在初始化语句 (如 static 变量和 static 块)，那就依次执行这些初始化语句。

### 双亲委派机制

当某个类加载器需要加载某个.class 文件时，它首先把这个任务委托给他的上级类加载器，递归这个操作，如果上级的类加载器没有加载，自己才会去加载这个类。

作用：

1、防止重复加载同一个.class。通过委托去向上面问一问，加载过了，就不用再加载一遍。保证数据安全。

2、保证核心.class 不能被篡改。

    通过委托方式，不会去篡改核心.class，即使篡改也不会去加载，即使加载也不会是同一个.class 对象了。
    不同的加载器加载同一个.class 也不是同一个 Class 对象。这样保证了 Class 执行安全。

